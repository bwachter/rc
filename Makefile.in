# Makefile.in for rc.

SHELL=/bin/sh

bindir=@bindir@
exec_prefix=@exec_prefix@
mandir=@mandir@
prefix=@prefix@

CC=@CC@
CFLAGS=@CFLAGS@
LDFLAGS=@CFLAGS@
LIBS=@LIBS@

INSTALL=@INSTALL@
INSTALL_DATA=@INSTALL_DATA@
INSTALL_PROGRAM=@INSTALL_PROGRAM@
LN=@LN@
YACC=@YACC@

HISTORY=@HISTORY@

OBJS=@ADDON@ builtins.o except.o exec.o @EXECVE@ fn.o footobar.o getopt.o \
	glob.o glom.o hash.o heredoc.o input.o lex.o list.o main.o match.o \
	nalloc.o open.o print.o redir.o sigmsgs.o signal.o status.o tree.o \
	utils.o var.o version.o wait.o walk.o which.o y.tab.o

all: rc $(HISTORY)

rc: $(OBJS)
	$(CC) -o $@ $(OBJS) $(LDFLAGS) $(LIBS)

sigmsgs.c: mksignal
	sh mksignal @SIGNAL_H@

y.tab.c: parse.y
	$(YACC) -d parse.y

trip: rc
	./rc -p < trip.rc

clean: force
	rm -f rc $(HISTORY) - *.o *.tab.* sigmsgs.* config.cache config.log

cleaner: clean
	rm -f config.status config.h Makefile

cleanest: cleaner
	rm -f configure

history: force
	cd history; make CC="$(CC)" $(HISTORYMAKEFLAGS)

install: all
	$(INSTALL_PROGRAM) rc $(bindir)
	$(INSTALL_DATA) rc.1 $(mandir)/man1/rc.1
	case "x$(HISTORY)" in \
	x) \
		;; \
	*) \
		$(LN) $(HISTORY) - ;\
		$(INSTALL_PROGRAM) - $(bindir) ;\
		$(LN) $(bindir)/- $(bindir)/-- ;\
		$(LN) $(bindir)/- $(bindir)/-p ;\
		$(LN) $(bindir)/- $(bindir)/--p ;\
		$(INSTALL_DATA) history/history.1 $(mandir)/man1/history.1 \
		;; \
	esac

force:

# dependencies:

$(OBJS): config.h proto.h rc.h
sigmsgs.h: sigmsgs.c
lex.o y.tab.o: y.tab.c

builtins.o except.o exec.o input.o signal.o utils.o wait.o walk.o: jbwrap.h
builtins.o: rlimit.h
builtins.o fn.o hash.o signal.o status.o: sigmsgs.h
